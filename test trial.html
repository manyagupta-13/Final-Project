
// Add this connections game data (put it near your other puzzle data)


// Add this function to create the connections game


// Modify the openCabinetDrawer function to include the connections game
function openCabinetDrawer(drawerNumber, e) {
    if (e) e.stopPropagation();
    
    const cabinetObj = interactiveObjects.find(obj => obj.userData.isCabinet);
    if (!cabinetObj) return;
    
    const drawer = cabinetObj.userData.drawers[drawerNumber - 1];
    if (!drawer) return;
    
    if (drawer.userData.locked) {
        if (drawerNumber === 1 || gameState.inventory.includes('small-key')) {
            // Unlock the drawer
            drawer.userData.locked = false;
            
            if (drawerNumber === 1) {
                // Top drawer - contains the connections game cards
                const result = `
                    <p>You open the top drawer and find 16 cards with various words printed on them.</p>
                    <p class="story-reveal">A note says: "Group these into 4 categories to reveal the first digit of the code."</p>
                `;
                
                // Animate drawer opening
                gsap.to(drawer.position, {
                    z: 0.5,
                    duration: 0.5,
                    onComplete: () => {
                        showModal("Cabinet Contents", result, `
                            <button class="interaction-button" onclick="showConnectionsGame(event)">Examine Cards</button>
                            <button class="interaction-button" onclick="showCabinetInteraction(event)">Back to Cabinet</button>
                        `);
                    }
                });
            } else if (drawerNumber === 2 && !gameState.inventory.includes('usb-drive')) {
                // Middle drawer - USB drive (existing code)
                addToInventory('usb-drive');
                gameState.usedItems.push('small-key');
                addClue('cabinet-opened');
                
                const result = `
                    <p>You unlock and open drawer ${drawerNumber}. Inside is a USB drive labeled "Project Phoenix".</p>
                    <p class="story-reveal">A note with the USB reads: 'Emergency override code: ${gameState.doorCode}'</p>
                `;
                
                // Animate drawer opening
                gsap.to(drawer.position, {
                    z: 0.5,
                    duration: 0.5,
                    onComplete: () => {
                        showModal("Cabinet Contents", result, `
                            <button class="interaction-button" onclick="showCabinetInteraction(event)">Back to Cabinet</button>
                        `);
                    }
                });
            } else {
                showModal("Cabinet Drawer", `Drawer ${drawerNumber} is empty.`, `
                    <button class="interaction-button" onclick="showCabinetInteraction(event)">Back to Cabinet</button>
                `);
            }
        } else {
            showModal("Locked Drawer", `Drawer ${drawerNumber} is locked. You need a key to open it.`, `
                <button class="interaction-button" onclick="showCabinetInteraction(event)">Back to Cabinet</button>
            `);
        }
    } else {
        // Drawer is already unlocked
        if (drawerNumber === 1) {
            // Top drawer - connections game
            showModal("Cabinet Drawer", "The top drawer contains the set of word cards.", `
                <button class="interaction-button" onclick="showConnectionsGame(event)">Examine Cards</button>
                <button class="interaction-button" onclick="showCabinetInteraction(event)">Back to Cabinet</button>
            `);
        } else if (drawerNumber === 2 && !gameState.inventory.includes('usb-drive')) {
            // Middle drawer - USB drive (existing code)
            addToInventory('usb-drive');
            const result = `
                <p>The drawer contains a USB drive labeled "Project Phoenix".</p>
                <p class="story-reveal">A note with the USB reads: 'Emergency override code: ${gameState.doorCode}'</p>
            `;
            showModal("Cabinet Contents", result, `
                <button class="interaction-button" onclick="showCabinetInteraction(event)">Back to Cabinet</button>
            `);
        } else {
            showModal("Cabinet Drawer", `Drawer ${drawerNumber} is empty.`, `
                <button class="interaction-button" onclick="showCabinetInteraction(event)">Back to Cabinet</button>
            `);
        }
    }
}

